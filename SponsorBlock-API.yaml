openapi: 3.1.0
info:
  title: SponsorBlock API
  version: '1.0'
  summary: SponsorBlock APi
  license:
    name: GPL v3.0
    identifier: GPL-3.0-only
  contact:
    name: Michael Chang
    url: 'https://github.com/mchangrh'
    email: michael@mchang.name
servers:
  - url: 'https://sponsor.ajay.app/api'
    description: Production Server
paths:
  /addUserAsVIP:
    post:
      summary: Add user as VIP
      operationId: postadduserasvip
      responses:
        '200':
          description: OK
        '400':
          description: Bad Request
        '403':
          description: Forbidden
      security:
        - adminUserID: []
      description: |-
        Add user to VIP table.

        VIPs have extra privileges and their votes count more.
      parameters:
        - schema:
            type: string
          in: query
          name: userID
          required: true
          description: Public userID of user to add to VIP list
        - schema:
            type: boolean
          in: query
          name: enabled
          description: enable or disable user
  /skipSegments:
    get:
      summary: Get Skip Segments
      tags: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                minItems: 1
                uniqueItems: true
                items:
                  $ref: '#/components/schemas/skipSegment'
        '404':
          description: Not Found
      operationId: getskipsegments
      description: Get segments to skip for a video
      parameters:
        - $ref: '#/components/parameters/videoID'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/categories'
        - $ref: '#/components/parameters/actionType'
        - $ref: '#/components/parameters/actionTypes'
        - $ref: '#/components/parameters/requiredSegment'
        - $ref: '#/components/parameters/requiredSegments'
        - $ref: '#/components/parameters/service'
    parameters: []
  '/skipSegments/{sha256HashPrefix}':
    get:
      summary: Get Skip Segments (Extra Privacy)
      tags: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/hashSkipSegment'
        '400':
          description: Bad Request
        '404':
          description: Not Found
      operationId: getSkipSegmentsByHash
      description: Get skip segments with extra privacy
      parameters:
        - schema:
            type: string
            minLength: 4
            pattern: '[A-Fa-f0-9]'
          in: query
          name: prefix
          description: can be used instead of path
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/categories'
        - $ref: '#/components/parameters/requiredSegment'
        - $ref: '#/components/parameters/requiredSegments'
        - $ref: '#/components/parameters/actionType'
        - $ref: '#/components/parameters/actionTypes'
        - $ref: '#/components/parameters/service'
    parameters:
      - schema:
          type: string
        name: sha256HashPrefix
        in: path
        description: hash of the YouTube videoID
components:
  schemas:
    skipSegment:
      type: object
      title: skipSegment
      properties:
        segment:
          type: array
          maxItems: 2
          minItems: 2
          description: start and end time in seconds
          items:
            type: integer
        UUID:
          $ref: '#/components/schemas/segmentUUID'
        category:
          $ref: '#/components/schemas/category'
        videoDuration:
          type: number
          minimum: 0
          description: Duration of video at time of submission
    segmentUUID:
      type: string
      title: segmentUUID
      pattern: '^[a-f0-9]{64,65}$'
      examples:
        - string
      format: segmentUUID
      description: UUID of segment
    publicUserID:
      type: string
      title: publicUserID
      pattern: '^[a-f0-9]{64}$'
      format: publicUserID
      description: Public userID (private userID hashed 5000 times)
    privateUserID:
      type: string
      title: privateUserID
      minLength: 32
      description: Private userID
    category:
      type: string
      enum:
        - sponsor
        - outro
        - selfpromo
        - interaction
        - intro
        - music_offtopic
        - preview
        - poi_highlight
      readOnly: true
      description: possible category types
    hashSkipSegment:
      type: array
      title: hashSkipSegment
      description: Privacy preserving skip segments
      minItems: 1
      uniqueItems: true
      items:
        type: object
        additionalProperties: false
        properties:
          videoID:
            type: string
            pattern: '^[0-9A-Za-z_-]{11}$'
          hash:
            type: string
            pattern: '^[A-Fa-f0-9]{64}$'
          segments:
            $ref: '#/components/schemas/skipSegment'
  securitySchemes:
    userID:
      name: loremipsum
      type: apiKey
      in: query
      description: Private userID
    adminUserID:
      name: foobar
      type: apiKey
      in: query
      description: Admin's private userID
  parameters:
    videoID:
      name: videoID
      in: query
      schema:
        type: string
        pattern: '^[0-9A-Za-z_-]{11}$'
        example: dQw4w9WgXcQ
      description: ID of video
    category:
      name: category
      in: query
      schema:
        type: string
        enum:
          - sponsor
          - selfpromo
          - interaction
          - intro
          - outro
          - preview
          - poi_highlight
          - music_offtopic
        default: sponsor
      description: Segment Category
    categories:
      name: categories
      in: query
      required: false
      schema:
        type: array
        minItems: 1
        default: sponsor
        enum:
          - sponsor
          - selfpromo
          - interaction
          - intro
          - outro
          - preview
          - music_offtopic
          - poi_highlight
        behavior: Read/Write
        uniqueItems: true
      style: spaceDelimited
      description: Array of categories
    actionType:
      name: actionType
      in: query
      schema:
        type: string
        enum:
          - skip
          - mute
        default: skip
      description: Action type
    actionTypes:
      name: actionTypes
      in: query
      schema:
        type: array
        enum:
          - skip
          - mute
        default: skip
        uniqueItems: true
        minItems: 1
      style: spaceDelimited
      description: multiple action types
    requiredSegment:
      name: requiredSegment
      in: query
      required: false
      schema:
        type: string
        pattern: '^([a-f0-9]{64,65}$'
      description: Segment UUID to get regardless of votes
    requiredSegments:
      name: requiredSegments
      in: query
      required: false
      schema:
        type: array
        minItems: 1
        uniqueItems: true
      description: Segment UUIDs to get regardless
    service:
      name: service
      in: query
      required: false
      schema:
        type: string
        enum:
          - YouTube
        default: YouTube
      description: Service to get segments for
  responses: {}
